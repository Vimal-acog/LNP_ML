Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 584 | train size = 584 | val size = 236 | test size = 236
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Epoch 0
Loss = 1.0002e+00, PNorm = 52.0836, GNorm = 5.0954, lr_0 = 5.5000e-04
Validation rmse = 1.002217
Epoch 1
Loss = 9.9280e-01, PNorm = 52.1301, GNorm = 2.7092, lr_0 = 1.0000e-03
Validation rmse = 1.079098
Epoch 2
Loss = 8.8471e-01, PNorm = 52.2123, GNorm = 2.4441, lr_0 = 9.5733e-04
Validation rmse = 0.989046
Epoch 3
Loss = 8.1330e-01, PNorm = 52.2848, GNorm = 2.4669, lr_0 = 9.1648e-04
Validation rmse = 0.975459
Epoch 4
Loss = 6.6568e-01, PNorm = 52.3641, GNorm = 2.2293, lr_0 = 8.7355e-04
Validation rmse = 0.938025
Epoch 5
Loss = 8.6375e-01, PNorm = 52.4151, GNorm = 2.8088, lr_0 = 8.3627e-04
Loss = 6.9668e-01, PNorm = 52.4561, GNorm = 2.3899, lr_0 = 8.0059e-04
Validation rmse = 0.912367
Epoch 6
Loss = 7.3813e-01, PNorm = 52.4989, GNorm = 2.5008, lr_0 = 7.6643e-04
Validation rmse = 0.880377
Epoch 7
Loss = 6.2051e-01, PNorm = 52.5366, GNorm = 1.8062, lr_0 = 7.3053e-04
Validation rmse = 0.930917
Epoch 8
Loss = 6.1035e-01, PNorm = 52.5711, GNorm = 2.2179, lr_0 = 6.9935e-04
Validation rmse = 0.891146
Epoch 9
Loss = 6.3234e-01, PNorm = 52.6044, GNorm = 1.7338, lr_0 = 6.6951e-04
Validation rmse = 0.842283
Epoch 10
Loss = 5.9700e-01, PNorm = 52.6430, GNorm = 1.9562, lr_0 = 6.3815e-04
Validation rmse = 0.852130
Epoch 11
Loss = 6.3733e-01, PNorm = 52.6673, GNorm = 1.4887, lr_0 = 6.1092e-04
Loss = 5.8417e-01, PNorm = 52.6958, GNorm = 2.2400, lr_0 = 5.8485e-04
Validation rmse = 0.905955
Epoch 12
Loss = 5.7366e-01, PNorm = 52.7274, GNorm = 2.0535, lr_0 = 5.5989e-04
Validation rmse = 0.927063
Epoch 13
Loss = 5.5720e-01, PNorm = 52.7568, GNorm = 1.4934, lr_0 = 5.3367e-04
Validation rmse = 0.921512
Epoch 14
Loss = 5.2437e-01, PNorm = 52.7816, GNorm = 2.0580, lr_0 = 5.1090e-04
Validation rmse = 0.853987
Epoch 15
Loss = 6.2393e-01, PNorm = 52.8150, GNorm = 2.8210, lr_0 = 4.8910e-04
Validation rmse = 0.844810
Epoch 16
Loss = 5.9746e-01, PNorm = 52.8485, GNorm = 1.0105, lr_0 = 4.6619e-04
Validation rmse = 0.862876
Epoch 17
Loss = 7.2282e-01, PNorm = 52.8727, GNorm = 1.7740, lr_0 = 4.4629e-04
Loss = 5.4970e-01, PNorm = 52.9023, GNorm = 1.7987, lr_0 = 4.2725e-04
Validation rmse = 0.850208
Epoch 18
Loss = 4.7256e-01, PNorm = 52.9318, GNorm = 0.8963, lr_0 = 4.0902e-04
Validation rmse = 0.869010
Epoch 19
Loss = 4.9598e-01, PNorm = 52.9604, GNorm = 1.4723, lr_0 = 3.8986e-04
Validation rmse = 0.843973
Epoch 20
Loss = 4.9609e-01, PNorm = 52.9824, GNorm = 1.0272, lr_0 = 3.7322e-04
Validation rmse = 0.903504
Epoch 21
Loss = 4.4052e-01, PNorm = 53.0058, GNorm = 0.9082, lr_0 = 3.5730e-04
Validation rmse = 0.876044
Epoch 22
Loss = 6.1961e-01, PNorm = 53.0323, GNorm = 1.4782, lr_0 = 3.4056e-04
Validation rmse = 0.837521
Epoch 23
Loss = 4.3035e-01, PNorm = 53.0553, GNorm = 0.6259, lr_0 = 3.2603e-04
Loss = 4.7820e-01, PNorm = 53.0729, GNorm = 1.4457, lr_0 = 3.1212e-04
Validation rmse = 0.843488
Epoch 24
Loss = 4.4555e-01, PNorm = 53.0924, GNorm = 2.0855, lr_0 = 2.9880e-04
Validation rmse = 0.847891
Epoch 25
Loss = 4.8758e-01, PNorm = 53.1117, GNorm = 2.1893, lr_0 = 2.8605e-04
Validation rmse = 0.851275
Epoch 26
Loss = 4.2611e-01, PNorm = 53.1349, GNorm = 2.6425, lr_0 = 2.7265e-04
Validation rmse = 0.856641
Epoch 27
Loss = 4.7942e-01, PNorm = 53.1511, GNorm = 1.3549, lr_0 = 2.6102e-04
Validation rmse = 0.832774
Epoch 28
Loss = 4.2213e-01, PNorm = 53.1683, GNorm = 1.7533, lr_0 = 2.4988e-04
Validation rmse = 0.857763
Epoch 29
Loss = 3.7593e-01, PNorm = 53.1870, GNorm = 1.1849, lr_0 = 2.3817e-04
Loss = 4.6858e-01, PNorm = 53.2014, GNorm = 1.4364, lr_0 = 2.2801e-04
Validation rmse = 0.828261
Epoch 30
Loss = 4.3403e-01, PNorm = 53.2199, GNorm = 2.2183, lr_0 = 2.1828e-04
Validation rmse = 0.830803
Epoch 31
Loss = 4.3131e-01, PNorm = 53.2354, GNorm = 0.8088, lr_0 = 2.0897e-04
Validation rmse = 0.863328
Epoch 32
Loss = 4.3385e-01, PNorm = 53.2501, GNorm = 0.9632, lr_0 = 1.9918e-04
Validation rmse = 0.828731
Epoch 33
Loss = 4.6879e-01, PNorm = 53.2645, GNorm = 1.6933, lr_0 = 1.9068e-04
Validation rmse = 0.857698
Epoch 34
Loss = 3.9870e-01, PNorm = 53.2769, GNorm = 2.5597, lr_0 = 1.8254e-04
Validation rmse = 0.839252
Epoch 35
Loss = 3.7424e-01, PNorm = 53.2918, GNorm = 1.5534, lr_0 = 1.7399e-04
Loss = 4.2915e-01, PNorm = 53.3030, GNorm = 1.7495, lr_0 = 1.6657e-04
Validation rmse = 0.821068
Epoch 36
Loss = 3.7997e-01, PNorm = 53.3163, GNorm = 1.2558, lr_0 = 1.5946e-04
Validation rmse = 0.837734
Epoch 37
Loss = 4.2808e-01, PNorm = 53.3280, GNorm = 1.7477, lr_0 = 1.5266e-04
Validation rmse = 0.818382
Epoch 38
Loss = 4.1933e-01, PNorm = 53.3397, GNorm = 1.4217, lr_0 = 1.4551e-04
Validation rmse = 0.834842
Epoch 39
Loss = 3.6686e-01, PNorm = 53.3492, GNorm = 1.1979, lr_0 = 1.3930e-04
Validation rmse = 0.840281
Epoch 40
Loss = 5.3582e-01, PNorm = 53.3589, GNorm = 1.3837, lr_0 = 1.3335e-04
Validation rmse = 0.842661
Epoch 41
Loss = 4.9454e-01, PNorm = 53.3714, GNorm = 1.3205, lr_0 = 1.2711e-04
Loss = 4.1170e-01, PNorm = 53.3800, GNorm = 1.7010, lr_0 = 1.2168e-04
Validation rmse = 0.846913
Epoch 42
Loss = 4.0915e-01, PNorm = 53.3883, GNorm = 0.9118, lr_0 = 1.1649e-04
Validation rmse = 0.809878
Epoch 43
Loss = 4.7487e-01, PNorm = 53.3980, GNorm = 1.6107, lr_0 = 1.1152e-04
Validation rmse = 0.853668
Epoch 44
Loss = 4.7618e-01, PNorm = 53.4059, GNorm = 1.6152, lr_0 = 1.0630e-04
Validation rmse = 0.840083
Epoch 45
Loss = 3.7860e-01, PNorm = 53.4130, GNorm = 2.3276, lr_0 = 1.0176e-04
Validation rmse = 0.819976
Epoch 46
Loss = 4.1626e-01, PNorm = 53.4185, GNorm = 1.3089, lr_0 = 1.0000e-04
Validation rmse = 0.867949
Epoch 47
Loss = 5.4132e-01, PNorm = 53.4283, GNorm = 1.5044, lr_0 = 1.0000e-04
Loss = 3.6935e-01, PNorm = 53.4334, GNorm = 1.9038, lr_0 = 1.0000e-04
Validation rmse = 0.809715
Epoch 48
Loss = 4.1914e-01, PNorm = 53.4444, GNorm = 1.2943, lr_0 = 1.0000e-04
Validation rmse = 0.835183
Epoch 49
Loss = 4.0455e-01, PNorm = 53.4510, GNorm = 1.4825, lr_0 = 1.0000e-04
Validation rmse = 0.829116
Model 0 best validation rmse = 0.809715 on epoch 47
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 0.809715
Ensemble test rmse = 0.809715
1-fold cross validation
	Seed 42 ==> test rmse = 0.809715
Overall test rmse = 0.809715 +/- 0.000000
Elapsed time = 0:06:50
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 679 | train size = 679 | val size = 141 | test size = 141
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Epoch 0
Loss = 1.0689e+00, PNorm = 52.0766, GNorm = 2.2765, lr_0 = 4.8077e-04
Validation rmse = 1.013484
Epoch 1
Loss = 8.7957e-01, PNorm = 52.1142, GNorm = 2.4906, lr_0 = 8.6154e-04
Validation rmse = 1.046678
Epoch 2
Loss = 7.3039e-01, PNorm = 52.1878, GNorm = 1.1262, lr_0 = 9.7810e-04
Loss = 8.9821e-01, PNorm = 52.2687, GNorm = 2.1699, lr_0 = 9.4267e-04
Loss = 9.9391e-01, PNorm = 52.2754, GNorm = 2.8766, lr_0 = 9.3920e-04
Validation rmse = 0.894907
Epoch 3
Loss = 8.6614e-01, PNorm = 52.3363, GNorm = 2.3918, lr_0 = 9.0517e-04
Validation rmse = 0.865384
Epoch 4
Loss = 8.7134e-01, PNorm = 52.3830, GNorm = 3.1066, lr_0 = 8.7238e-04
Validation rmse = 0.899607
Epoch 5
Loss = 6.6272e-01, PNorm = 52.4414, GNorm = 0.9168, lr_0 = 8.3768e-04
Loss = 7.5716e-01, PNorm = 52.4914, GNorm = 1.6197, lr_0 = 8.0733e-04
Validation rmse = 0.866060
Epoch 6
Loss = 7.4773e-01, PNorm = 52.5206, GNorm = 1.6468, lr_0 = 7.7808e-04
Validation rmse = 0.830421
Epoch 7
Loss = 7.1807e-01, PNorm = 52.5548, GNorm = 0.9879, lr_0 = 7.4989e-04
Validation rmse = 0.792083
Epoch 8
Loss = 6.5402e-01, PNorm = 52.5975, GNorm = 1.1359, lr_0 = 7.2007e-04
Loss = 6.5705e-01, PNorm = 52.6338, GNorm = 1.3455, lr_0 = 6.9398e-04
Validation rmse = 0.783340
Epoch 9
Loss = 7.1135e-01, PNorm = 52.6653, GNorm = 3.1525, lr_0 = 6.6884e-04
Validation rmse = 0.861338
Epoch 10
Loss = 6.5254e-01, PNorm = 52.7072, GNorm = 2.1524, lr_0 = 6.4223e-04
Validation rmse = 0.825452
Epoch 11
Loss = 5.3239e-01, PNorm = 52.7351, GNorm = 2.5904, lr_0 = 6.1897e-04
Loss = 6.5589e-01, PNorm = 52.7674, GNorm = 1.5602, lr_0 = 5.9654e-04
Validation rmse = 0.744755
Epoch 12
Loss = 6.3894e-01, PNorm = 52.8006, GNorm = 1.3288, lr_0 = 5.7281e-04
Validation rmse = 0.782121
Epoch 13
Loss = 7.5625e-01, PNorm = 52.8380, GNorm = 2.8147, lr_0 = 5.5206e-04
Loss = 6.2984e-01, PNorm = 52.8759, GNorm = 2.8641, lr_0 = 5.3206e-04
Validation rmse = 0.775629
Epoch 14
Loss = 6.8158e-01, PNorm = 52.9092, GNorm = 0.9637, lr_0 = 5.1279e-04
Validation rmse = 0.770280
Epoch 15
Loss = 5.4562e-01, PNorm = 52.9482, GNorm = 1.3121, lr_0 = 4.9239e-04
Validation rmse = 0.818868
Epoch 16
Loss = 5.6412e-01, PNorm = 52.9829, GNorm = 1.5781, lr_0 = 4.7455e-04
Loss = 5.9855e-01, PNorm = 53.0228, GNorm = 2.1254, lr_0 = 4.5736e-04
Loss = 6.8712e-01, PNorm = 53.0259, GNorm = 3.2121, lr_0 = 4.5567e-04
Validation rmse = 0.761283
Epoch 17
Loss = 5.0870e-01, PNorm = 53.0580, GNorm = 1.4533, lr_0 = 4.3917e-04
Validation rmse = 0.762645
Epoch 18
Loss = 4.9703e-01, PNorm = 53.0995, GNorm = 1.9076, lr_0 = 4.2326e-04
Validation rmse = 0.783950
Epoch 19
Loss = 5.8300e-01, PNorm = 53.1361, GNorm = 0.7742, lr_0 = 4.0792e-04
Loss = 5.1646e-01, PNorm = 53.1728, GNorm = 1.7263, lr_0 = 3.9314e-04
Validation rmse = 0.782236
Epoch 20
Loss = 5.4710e-01, PNorm = 53.2094, GNorm = 1.8484, lr_0 = 3.7751e-04
Validation rmse = 0.747457
Epoch 21
Loss = 5.9380e-01, PNorm = 53.2428, GNorm = 1.6180, lr_0 = 3.6383e-04
Validation rmse = 0.802359
Epoch 22
Loss = 4.3986e-01, PNorm = 53.2799, GNorm = 2.3384, lr_0 = 3.4936e-04
Loss = 5.3830e-01, PNorm = 53.3116, GNorm = 2.4730, lr_0 = 3.3670e-04
Validation rmse = 0.815987
Epoch 23
Loss = 4.5698e-01, PNorm = 53.3463, GNorm = 4.1869, lr_0 = 3.2450e-04
Validation rmse = 0.771045
Epoch 24
Loss = 5.0925e-01, PNorm = 53.3793, GNorm = 1.3250, lr_0 = 3.1159e-04
Validation rmse = 0.806502
Epoch 25
Loss = 6.0097e-01, PNorm = 53.4043, GNorm = 2.2662, lr_0 = 3.0031e-04
Loss = 4.9799e-01, PNorm = 53.4287, GNorm = 3.6818, lr_0 = 2.8943e-04
Validation rmse = 0.801768
Epoch 26
Loss = 4.4395e-01, PNorm = 53.4552, GNorm = 1.2334, lr_0 = 2.7894e-04
Validation rmse = 0.803146
Epoch 27
Loss = 3.9528e-01, PNorm = 53.4798, GNorm = 1.1780, lr_0 = 2.6785e-04
Loss = 4.6051e-01, PNorm = 53.5041, GNorm = 2.8492, lr_0 = 2.5814e-04
Validation rmse = 0.788725
Epoch 28
Loss = 4.0030e-01, PNorm = 53.5229, GNorm = 0.8920, lr_0 = 2.4879e-04
Validation rmse = 0.783740
Epoch 29
Loss = 3.4121e-01, PNorm = 53.5428, GNorm = 2.1025, lr_0 = 2.3889e-04
Validation rmse = 0.801818
Epoch 30
Loss = 2.7320e-01, PNorm = 53.5593, GNorm = 0.9821, lr_0 = 2.3024e-04
Loss = 4.4257e-01, PNorm = 53.5765, GNorm = 1.7424, lr_0 = 2.2190e-04
Loss = 4.4579e-01, PNorm = 53.5786, GNorm = 2.0309, lr_0 = 2.2108e-04
Validation rmse = 0.784197
Epoch 31
Loss = 4.1535e-01, PNorm = 53.5933, GNorm = 1.4781, lr_0 = 2.1307e-04
Validation rmse = 0.797433
Epoch 32
Loss = 3.5082e-01, PNorm = 53.6106, GNorm = 2.9420, lr_0 = 2.0535e-04
Validation rmse = 0.824953
Epoch 33
Loss = 5.7791e-01, PNorm = 53.6275, GNorm = 1.6797, lr_0 = 1.9791e-04
Loss = 3.4048e-01, PNorm = 53.6418, GNorm = 2.1035, lr_0 = 1.9074e-04
Validation rmse = 0.817356
Epoch 34
Loss = 4.2868e-01, PNorm = 53.6568, GNorm = 1.4460, lr_0 = 1.8316e-04
Validation rmse = 0.804885
Epoch 35
Loss = 3.5770e-01, PNorm = 53.6704, GNorm = 1.9988, lr_0 = 1.7652e-04
Validation rmse = 0.815203
Epoch 36
Loss = 3.5808e-01, PNorm = 53.6833, GNorm = 1.7200, lr_0 = 1.6950e-04
Loss = 4.1847e-01, PNorm = 53.6940, GNorm = 1.4224, lr_0 = 1.6336e-04
Validation rmse = 0.822431
Epoch 37
Loss = 3.7877e-01, PNorm = 53.7038, GNorm = 2.4172, lr_0 = 1.5744e-04
Validation rmse = 0.804458
Epoch 38
Loss = 4.1736e-01, PNorm = 53.7155, GNorm = 1.3314, lr_0 = 1.5174e-04
Validation rmse = 0.805618
Epoch 39
Loss = 2.7641e-01, PNorm = 53.7269, GNorm = 1.0701, lr_0 = 1.4570e-04
Loss = 3.6275e-01, PNorm = 53.7379, GNorm = 2.0868, lr_0 = 1.4042e-04
Validation rmse = 0.806278
Epoch 40
Loss = 3.5186e-01, PNorm = 53.7487, GNorm = 0.9154, lr_0 = 1.3534e-04
Validation rmse = 0.794791
Epoch 41
Loss = 3.2115e-01, PNorm = 53.7568, GNorm = 1.6883, lr_0 = 1.2995e-04
Loss = 3.9285e-01, PNorm = 53.7644, GNorm = 2.1102, lr_0 = 1.2524e-04
Validation rmse = 0.806144
Epoch 42
Loss = 3.0767e-01, PNorm = 53.7725, GNorm = 1.4349, lr_0 = 1.2071e-04
Validation rmse = 0.807755
Epoch 43
Loss = 3.6553e-01, PNorm = 53.7806, GNorm = 4.4642, lr_0 = 1.1591e-04
Validation rmse = 0.803335
Epoch 44
Loss = 4.1620e-01, PNorm = 53.7891, GNorm = 3.7800, lr_0 = 1.1171e-04
Loss = 3.7635e-01, PNorm = 53.7947, GNorm = 1.6272, lr_0 = 1.0766e-04
Validation rmse = 0.815449
Epoch 45
Loss = 3.3892e-01, PNorm = 53.8043, GNorm = 1.1731, lr_0 = 1.0376e-04
Validation rmse = 0.813995
Epoch 46
Loss = 4.0781e-01, PNorm = 53.8108, GNorm = 0.9179, lr_0 = 1.0000e-04
Validation rmse = 0.818844
Epoch 47
Loss = 3.6450e-01, PNorm = 53.8191, GNorm = 2.4006, lr_0 = 1.0000e-04
Loss = 3.6014e-01, PNorm = 53.8251, GNorm = 1.1065, lr_0 = 1.0000e-04
Validation rmse = 0.797137
Epoch 48
Loss = 3.4971e-01, PNorm = 53.8325, GNorm = 1.1674, lr_0 = 1.0000e-04
Validation rmse = 0.803357
Epoch 49
Loss = 3.9465e-01, PNorm = 53.8379, GNorm = 1.4062, lr_0 = 1.0000e-04
Validation rmse = 0.837026
Model 0 best validation rmse = 0.744755 on epoch 11
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 0.744755
Ensemble test rmse = 0.744755
1-fold cross validation
	Seed 42 ==> test rmse = 0.744755
Overall test rmse = 0.744755 +/- 0.000000
Elapsed time = 0:07:02
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 635 | train size = 635 | val size = 185 | test size = 185
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Epoch 0
Loss = 1.1414e+00, PNorm = 52.0780, GNorm = 6.3003, lr_0 = 5.1250e-04
Validation rmse = 1.072673
Epoch 1
Loss = 1.1399e+00, PNorm = 52.1218, GNorm = 1.2137, lr_0 = 9.2500e-04
Validation rmse = 0.882781
Epoch 2
Loss = 1.0824e+00, PNorm = 52.2020, GNorm = 1.2796, lr_0 = 9.6853e-04
Validation rmse = 0.950654
Epoch 3
Loss = 1.0020e+00, PNorm = 52.2915, GNorm = 1.0714, lr_0 = 9.3057e-04
Loss = 7.4752e-01, PNorm = 52.3535, GNorm = 3.7256, lr_0 = 8.9411e-04
Loss = 8.5238e-01, PNorm = 52.3594, GNorm = 1.9699, lr_0 = 8.9054e-04
Validation rmse = 1.092379
Epoch 4
Loss = 7.7076e-01, PNorm = 52.4021, GNorm = 2.5669, lr_0 = 8.5564e-04
Validation rmse = 0.955130
Epoch 5
Loss = 6.1217e-01, PNorm = 52.4420, GNorm = 2.5134, lr_0 = 8.2211e-04
Validation rmse = 0.857834
Epoch 6
Loss = 5.4362e-01, PNorm = 52.4836, GNorm = 1.7896, lr_0 = 7.8990e-04
Validation rmse = 0.935749
Epoch 7
Loss = 6.4825e-01, PNorm = 52.5263, GNorm = 3.4988, lr_0 = 7.5591e-04
Loss = 6.7008e-01, PNorm = 52.5625, GNorm = 1.9627, lr_0 = 7.2629e-04
Validation rmse = 0.897371
Epoch 8
Loss = 6.9941e-01, PNorm = 52.5997, GNorm = 3.2786, lr_0 = 6.9783e-04
Validation rmse = 0.985389
Epoch 9
Loss = 6.8943e-01, PNorm = 52.6371, GNorm = 2.9700, lr_0 = 6.7048e-04
Validation rmse = 0.962769
Epoch 10
Loss = 5.0603e-01, PNorm = 52.6759, GNorm = 1.9548, lr_0 = 6.4421e-04
Validation rmse = 0.975078
Epoch 11
Loss = 6.8653e-01, PNorm = 52.7114, GNorm = 2.0149, lr_0 = 6.1650e-04
Loss = 5.5059e-01, PNorm = 52.7398, GNorm = 1.1331, lr_0 = 5.9234e-04
Validation rmse = 0.919090
Epoch 12
Loss = 5.0627e-01, PNorm = 52.7731, GNorm = 2.3083, lr_0 = 5.6913e-04
Validation rmse = 0.876593
Epoch 13
Loss = 4.4143e-01, PNorm = 52.7982, GNorm = 1.1255, lr_0 = 5.4682e-04
Validation rmse = 0.955669
Epoch 14
Loss = 4.7890e-01, PNorm = 52.8289, GNorm = 2.2047, lr_0 = 5.2330e-04
Loss = 5.5096e-01, PNorm = 52.8498, GNorm = 2.1188, lr_0 = 5.0279e-04
Validation rmse = 0.932735
Epoch 15
Loss = 6.0288e-01, PNorm = 52.8692, GNorm = 1.4778, lr_0 = 4.8309e-04
Validation rmse = 0.954971
Epoch 16
Loss = 4.7866e-01, PNorm = 52.8964, GNorm = 1.0908, lr_0 = 4.6416e-04
Validation rmse = 0.941208
Epoch 17
Loss = 4.2771e-01, PNorm = 52.9170, GNorm = 2.0261, lr_0 = 4.4419e-04
Validation rmse = 0.921291
Epoch 18
Loss = 5.3581e-01, PNorm = 52.9439, GNorm = 0.9853, lr_0 = 4.2678e-04
Loss = 5.2153e-01, PNorm = 52.9677, GNorm = 1.7489, lr_0 = 4.1006e-04
Validation rmse = 0.961479
Epoch 19
Loss = 4.8857e-01, PNorm = 52.9843, GNorm = 0.9174, lr_0 = 3.9399e-04
Validation rmse = 0.931115
Epoch 20
Loss = 3.8498e-01, PNorm = 53.0040, GNorm = 1.1388, lr_0 = 3.7855e-04
Validation rmse = 0.917393
Epoch 21
Loss = 3.2136e-01, PNorm = 53.0240, GNorm = 0.9019, lr_0 = 3.6227e-04
Validation rmse = 0.922058
Epoch 22
Loss = 2.8533e-01, PNorm = 53.0414, GNorm = 1.0271, lr_0 = 3.4807e-04
Loss = 4.8816e-01, PNorm = 53.0584, GNorm = 1.3692, lr_0 = 3.3443e-04
Validation rmse = 0.919883
Epoch 23
Loss = 5.3625e-01, PNorm = 53.0803, GNorm = 1.6767, lr_0 = 3.2132e-04
Validation rmse = 0.931082
Epoch 24
Loss = 4.3703e-01, PNorm = 53.0967, GNorm = 1.6253, lr_0 = 3.0750e-04
Validation rmse = 0.936028
Epoch 25
Loss = 5.7031e-01, PNorm = 53.1155, GNorm = 1.1140, lr_0 = 2.9545e-04
Loss = 4.4698e-01, PNorm = 53.1341, GNorm = 1.4220, lr_0 = 2.8387e-04
Validation rmse = 0.872022
Epoch 26
Loss = 4.6493e-01, PNorm = 53.1511, GNorm = 1.4917, lr_0 = 2.7275e-04
Validation rmse = 0.871087
Epoch 27
Loss = 4.1509e-01, PNorm = 53.1677, GNorm = 1.3200, lr_0 = 2.6102e-04
Validation rmse = 0.893816
Epoch 28
Loss = 4.3955e-01, PNorm = 53.1835, GNorm = 0.9327, lr_0 = 2.5079e-04
Validation rmse = 0.900495
Epoch 29
Loss = 3.2483e-01, PNorm = 53.1982, GNorm = 1.5485, lr_0 = 2.4096e-04
Loss = 4.9170e-01, PNorm = 53.2155, GNorm = 1.2991, lr_0 = 2.3152e-04
Validation rmse = 0.851229
Epoch 30
Loss = 4.4858e-01, PNorm = 53.2292, GNorm = 0.9631, lr_0 = 2.2244e-04
Validation rmse = 0.881257
Epoch 31
Loss = 3.6595e-01, PNorm = 53.2470, GNorm = 0.9592, lr_0 = 2.1288e-04
Validation rmse = 0.879504
Epoch 32
Loss = 5.9848e-01, PNorm = 53.2591, GNorm = 1.5590, lr_0 = 2.0453e-04
Validation rmse = 0.873444
Epoch 33
Loss = 3.3822e-01, PNorm = 53.2707, GNorm = 1.0168, lr_0 = 1.9652e-04
Loss = 4.4826e-01, PNorm = 53.2839, GNorm = 1.5723, lr_0 = 1.8882e-04
Validation rmse = 0.854173
Epoch 34
Loss = 4.0056e-01, PNorm = 53.2953, GNorm = 1.1576, lr_0 = 1.8069e-04
Validation rmse = 0.859006
Epoch 35
Loss = 4.4763e-01, PNorm = 53.3071, GNorm = 1.2099, lr_0 = 1.7361e-04
Validation rmse = 0.826833
Epoch 36
Loss = 3.5727e-01, PNorm = 53.3189, GNorm = 1.0219, lr_0 = 1.6681e-04
Validation rmse = 0.818373
Epoch 37
Loss = 1.5467e-01, PNorm = 53.3316, GNorm = 0.6642, lr_0 = 1.5963e-04
Loss = 4.9262e-01, PNorm = 53.3441, GNorm = 2.4788, lr_0 = 1.5338e-04
Validation rmse = 0.806179
Epoch 38
Loss = 4.4132e-01, PNorm = 53.3530, GNorm = 1.6057, lr_0 = 1.4737e-04
Validation rmse = 0.826268
Epoch 39
Loss = 3.4910e-01, PNorm = 53.3655, GNorm = 3.3321, lr_0 = 1.4159e-04
Validation rmse = 0.860394
Epoch 40
Loss = 3.8744e-01, PNorm = 53.3764, GNorm = 2.1800, lr_0 = 1.3604e-04
Loss = 4.4845e-01, PNorm = 53.3868, GNorm = 1.3286, lr_0 = 1.3071e-04
Loss = 2.7814e-01, PNorm = 53.3875, GNorm = 1.4403, lr_0 = 1.3019e-04
Validation rmse = 0.801517
Epoch 41
Loss = 3.5122e-01, PNorm = 53.3964, GNorm = 1.6117, lr_0 = 1.2509e-04
Validation rmse = 0.844295
Epoch 42
Loss = 4.3121e-01, PNorm = 53.4059, GNorm = 1.8148, lr_0 = 1.2019e-04
Validation rmse = 0.815339
Epoch 43
Loss = 3.9292e-01, PNorm = 53.4128, GNorm = 0.8831, lr_0 = 1.1548e-04
Validation rmse = 0.819019
Epoch 44
Loss = 3.4235e-01, PNorm = 53.4215, GNorm = 0.9950, lr_0 = 1.1051e-04
Loss = 3.9467e-01, PNorm = 53.4303, GNorm = 1.1235, lr_0 = 1.0618e-04
Validation rmse = 0.777941
Epoch 45
Loss = 3.4962e-01, PNorm = 53.4359, GNorm = 1.3637, lr_0 = 1.0202e-04
Validation rmse = 0.821835
Epoch 46
Loss = 3.9463e-01, PNorm = 53.4435, GNorm = 0.9257, lr_0 = 1.0000e-04
Validation rmse = 0.804818
Epoch 47
Loss = 4.0267e-01, PNorm = 53.4509, GNorm = 3.4291, lr_0 = 1.0000e-04
Validation rmse = 0.767744
Epoch 48
Loss = 9.0619e-01, PNorm = 53.4584, GNorm = 2.3954, lr_0 = 1.0000e-04
Loss = 3.9192e-01, PNorm = 53.4646, GNorm = 2.2336, lr_0 = 1.0000e-04
Validation rmse = 0.782902
Epoch 49
Loss = 4.2670e-01, PNorm = 53.4719, GNorm = 1.8277, lr_0 = 1.0000e-04
Validation rmse = 0.800408
Model 0 best validation rmse = 0.767744 on epoch 47
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 0.767744
Ensemble test rmse = 0.767744
1-fold cross validation
	Seed 42 ==> test rmse = 0.767744
Overall test rmse = 0.767744 +/- 0.000000
Elapsed time = 0:07:07
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 686 | train size = 686 | val size = 134 | test size = 134
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Epoch 0
Loss = 1.1327e+00, PNorm = 52.0798, GNorm = 2.7713, lr_0 = 4.8077e-04
Validation rmse = 1.198835
Epoch 1
Loss = 1.0816e+00, PNorm = 52.1128, GNorm = 3.9037, lr_0 = 8.6154e-04
Validation rmse = 1.198895
Epoch 2
Loss = 1.2703e+00, PNorm = 52.1895, GNorm = 2.1269, lr_0 = 9.7810e-04
Loss = 1.0300e+00, PNorm = 52.2843, GNorm = 3.9765, lr_0 = 9.4267e-04
Validation rmse = 1.106391
Epoch 3
Loss = 9.2108e-01, PNorm = 52.3684, GNorm = 1.0386, lr_0 = 9.0852e-04
Validation rmse = 1.171448
Epoch 4
Loss = 8.3331e-01, PNorm = 52.4352, GNorm = 1.9252, lr_0 = 8.7238e-04
Validation rmse = 1.095056
Epoch 5
Loss = 6.5221e-01, PNorm = 52.4790, GNorm = 0.9510, lr_0 = 8.4077e-04
Loss = 8.0871e-01, PNorm = 52.5244, GNorm = 1.0482, lr_0 = 8.1031e-04
Validation rmse = 1.139461
Epoch 6
Loss = 7.1376e-01, PNorm = 52.5692, GNorm = 2.7634, lr_0 = 7.8096e-04
Validation rmse = 1.100186
Epoch 7
Loss = 8.6449e-01, PNorm = 52.6121, GNorm = 3.2016, lr_0 = 7.5267e-04
Validation rmse = 1.155374
Epoch 8
Loss = 6.5947e-01, PNorm = 52.6693, GNorm = 1.7802, lr_0 = 7.2273e-04
Loss = 6.5598e-01, PNorm = 52.7080, GNorm = 0.9933, lr_0 = 6.9654e-04
Validation rmse = 1.165033
Epoch 9
Loss = 6.9754e-01, PNorm = 52.7483, GNorm = 2.3767, lr_0 = 6.7131e-04
Validation rmse = 1.192500
Epoch 10
Loss = 7.2722e-01, PNorm = 52.7854, GNorm = 1.3001, lr_0 = 6.4699e-04
Loss = 6.5617e-01, PNorm = 52.8142, GNorm = 0.9825, lr_0 = 6.2355e-04
Loss = 5.8777e-01, PNorm = 52.8168, GNorm = 0.9924, lr_0 = 6.2125e-04
Validation rmse = 1.104767
Epoch 11
Loss = 6.6470e-01, PNorm = 52.8569, GNorm = 1.0559, lr_0 = 5.9875e-04
Validation rmse = 1.134856
Epoch 12
Loss = 5.4322e-01, PNorm = 52.8879, GNorm = 1.1060, lr_0 = 5.7706e-04
Validation rmse = 1.125347
Epoch 13
Loss = 5.3260e-01, PNorm = 52.9209, GNorm = 1.0393, lr_0 = 5.5615e-04
Loss = 6.0589e-01, PNorm = 52.9574, GNorm = 1.4441, lr_0 = 5.3600e-04
Validation rmse = 1.105668
Epoch 14
Loss = 5.8244e-01, PNorm = 52.9923, GNorm = 1.9169, lr_0 = 5.1658e-04
Validation rmse = 1.133437
Epoch 15
Loss = 4.9926e-01, PNorm = 53.0291, GNorm = 1.4126, lr_0 = 4.9604e-04
Validation rmse = 1.093590
Epoch 16
Loss = 3.9846e-01, PNorm = 53.0641, GNorm = 1.0768, lr_0 = 4.7807e-04
Loss = 5.4323e-01, PNorm = 53.1000, GNorm = 1.1673, lr_0 = 4.6075e-04
Validation rmse = 1.089316
Epoch 17
Loss = 5.4007e-01, PNorm = 53.1325, GNorm = 1.8906, lr_0 = 4.4405e-04
Validation rmse = 1.115302
Epoch 18
Loss = 4.2784e-01, PNorm = 53.1654, GNorm = 2.0831, lr_0 = 4.2639e-04
Loss = 5.0965e-01, PNorm = 53.1925, GNorm = 1.4513, lr_0 = 4.1094e-04
Validation rmse = 1.072168
Epoch 19
Loss = 4.9643e-01, PNorm = 53.2206, GNorm = 1.4284, lr_0 = 3.9606e-04
Validation rmse = 1.097249
Epoch 20
Loss = 4.9015e-01, PNorm = 53.2513, GNorm = 1.2338, lr_0 = 3.8171e-04
Validation rmse = 1.143841
Epoch 21
Loss = 5.8059e-01, PNorm = 53.2752, GNorm = 1.4356, lr_0 = 3.6788e-04
Loss = 4.3189e-01, PNorm = 53.3017, GNorm = 1.9415, lr_0 = 3.5455e-04
Validation rmse = 1.105815
Epoch 22
Loss = 4.9829e-01, PNorm = 53.3273, GNorm = 1.3758, lr_0 = 3.4045e-04
Validation rmse = 1.129699
Epoch 23
Loss = 5.6632e-01, PNorm = 53.3530, GNorm = 5.8704, lr_0 = 3.2811e-04
Validation rmse = 1.088880
Epoch 24
Loss = 3.3669e-01, PNorm = 53.3805, GNorm = 1.2031, lr_0 = 3.1623e-04
Loss = 4.4088e-01, PNorm = 53.4046, GNorm = 2.1820, lr_0 = 3.0477e-04
Validation rmse = 1.113745
Epoch 25
Loss = 4.7303e-01, PNorm = 53.4228, GNorm = 1.3728, lr_0 = 2.9373e-04
Validation rmse = 1.082961
Epoch 26
Loss = 5.5250e-01, PNorm = 53.4429, GNorm = 2.2396, lr_0 = 2.8205e-04
Loss = 4.0419e-01, PNorm = 53.4592, GNorm = 1.1700, lr_0 = 2.7183e-04
Validation rmse = 1.080499
Epoch 27
Loss = 4.2850e-01, PNorm = 53.4771, GNorm = 1.0677, lr_0 = 2.6198e-04
Validation rmse = 1.094940
Epoch 28
Loss = 3.6565e-01, PNorm = 53.4949, GNorm = 1.7486, lr_0 = 2.5249e-04
Validation rmse = 1.087874
Epoch 29
Loss = 4.7383e-01, PNorm = 53.5111, GNorm = 0.9247, lr_0 = 2.4245e-04
Loss = 4.2162e-01, PNorm = 53.5244, GNorm = 2.9408, lr_0 = 2.3366e-04
Validation rmse = 1.100584
Epoch 30
Loss = 4.2569e-01, PNorm = 53.5397, GNorm = 1.8499, lr_0 = 2.2520e-04
Validation rmse = 1.085264
Epoch 31
Loss = 4.2267e-01, PNorm = 53.5537, GNorm = 2.9780, lr_0 = 2.1704e-04
Validation rmse = 1.091153
Epoch 32
Loss = 4.1173e-01, PNorm = 53.5681, GNorm = 1.5821, lr_0 = 2.0918e-04
Loss = 4.6304e-01, PNorm = 53.5833, GNorm = 1.9337, lr_0 = 2.0160e-04
Validation rmse = 1.093966
Epoch 33
Loss = 3.8825e-01, PNorm = 53.5973, GNorm = 1.8767, lr_0 = 1.9358e-04
Validation rmse = 1.089042
Epoch 34
Loss = 4.4282e-01, PNorm = 53.6118, GNorm = 1.3405, lr_0 = 1.8657e-04
Loss = 4.0363e-01, PNorm = 53.6237, GNorm = 1.1125, lr_0 = 1.7981e-04
Validation rmse = 1.089640
Epoch 35
Loss = 3.8352e-01, PNorm = 53.6334, GNorm = 1.7590, lr_0 = 1.7329e-04
Validation rmse = 1.108629
Epoch 36
Loss = 4.2141e-01, PNorm = 53.6457, GNorm = 1.8956, lr_0 = 1.6640e-04
Validation rmse = 1.074461
Epoch 37
Loss = 3.4777e-01, PNorm = 53.6569, GNorm = 1.6742, lr_0 = 1.6037e-04
Loss = 4.0383e-01, PNorm = 53.6660, GNorm = 1.8558, lr_0 = 1.5456e-04
Validation rmse = 1.107640
Epoch 38
Loss = 3.8332e-01, PNorm = 53.6752, GNorm = 2.0867, lr_0 = 1.4896e-04
Validation rmse = 1.082435
Epoch 39
Loss = 3.5448e-01, PNorm = 53.6838, GNorm = 0.9770, lr_0 = 1.4357e-04
Validation rmse = 1.094339
Epoch 40
Loss = 3.0628e-01, PNorm = 53.6910, GNorm = 1.5204, lr_0 = 1.3786e-04
Loss = 4.2601e-01, PNorm = 53.7005, GNorm = 2.3977, lr_0 = 1.3286e-04
Validation rmse = 1.097552
Epoch 41
Loss = 4.0511e-01, PNorm = 53.7076, GNorm = 2.4133, lr_0 = 1.2805e-04
Validation rmse = 1.091472
Epoch 42
Loss = 4.5782e-01, PNorm = 53.7161, GNorm = 1.5484, lr_0 = 1.2341e-04
Validation rmse = 1.094543
Epoch 43
Loss = 3.0620e-01, PNorm = 53.7228, GNorm = 1.1720, lr_0 = 1.1850e-04
Loss = 4.0912e-01, PNorm = 53.7298, GNorm = 1.9156, lr_0 = 1.1421e-04
Validation rmse = 1.088233
Epoch 44
Loss = 4.0553e-01, PNorm = 53.7370, GNorm = 1.6167, lr_0 = 1.1007e-04
Validation rmse = 1.094518
Epoch 45
Loss = 3.4749e-01, PNorm = 53.7430, GNorm = 2.3196, lr_0 = 1.0608e-04
Loss = 3.7816e-01, PNorm = 53.7485, GNorm = 1.6064, lr_0 = 1.0224e-04
Validation rmse = 1.098043
Epoch 46
Loss = 3.9525e-01, PNorm = 53.7537, GNorm = 1.3473, lr_0 = 1.0000e-04
Validation rmse = 1.100104
Epoch 47
Loss = 3.5565e-01, PNorm = 53.7592, GNorm = 2.3744, lr_0 = 1.0000e-04
Validation rmse = 1.100843
Epoch 48
Loss = 4.5493e-01, PNorm = 53.7653, GNorm = 2.9586, lr_0 = 1.0000e-04
Loss = 3.7064e-01, PNorm = 53.7705, GNorm = 1.2563, lr_0 = 1.0000e-04
Validation rmse = 1.087292
Epoch 49
Loss = 3.6676e-01, PNorm = 53.7755, GNorm = 1.8115, lr_0 = 1.0000e-04
Validation rmse = 1.116932
Model 0 best validation rmse = 1.072168 on epoch 18
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 1.072168
Ensemble test rmse = 1.072168
1-fold cross validation
	Seed 42 ==> test rmse = 1.072168
Overall test rmse = 1.072168 +/- 0.000000
Elapsed time = 0:07:12
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/valid.csv',
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 696 | train size = 696 | val size = 124 | test size = 124
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Epoch 0
Loss = 1.0602e+00, PNorm = 52.0793, GNorm = 2.9841, lr_0 = 4.8077e-04
Validation rmse = 1.081243
Epoch 1
Loss = 1.0775e+00, PNorm = 52.1110, GNorm = 3.2462, lr_0 = 8.6154e-04
Validation rmse = 1.108900
Epoch 2
Loss = 9.6769e-01, PNorm = 52.1822, GNorm = 1.5918, lr_0 = 9.7810e-04
Loss = 9.2016e-01, PNorm = 52.2666, GNorm = 1.3441, lr_0 = 9.4267e-04
Validation rmse = 1.073749
Epoch 3
Loss = 7.9701e-01, PNorm = 52.3386, GNorm = 1.6343, lr_0 = 9.0852e-04
Validation rmse = 0.938410
Epoch 4
Loss = 7.1624e-01, PNorm = 52.3875, GNorm = 7.3531, lr_0 = 8.7560e-04
Validation rmse = 1.011160
Epoch 5
Loss = 8.5578e-01, PNorm = 52.4293, GNorm = 1.6894, lr_0 = 8.4388e-04
Loss = 7.0149e-01, PNorm = 52.4673, GNorm = 3.3803, lr_0 = 8.1331e-04
Validation rmse = 0.994624
Epoch 6
Loss = 8.5870e-01, PNorm = 52.4987, GNorm = 1.7070, lr_0 = 7.8385e-04
Validation rmse = 0.986810
Epoch 7
Loss = 7.6906e-01, PNorm = 52.5300, GNorm = 1.9275, lr_0 = 7.5545e-04
Loss = 6.5989e-01, PNorm = 52.5656, GNorm = 0.9876, lr_0 = 7.2808e-04
Validation rmse = 0.900763
Epoch 8
Loss = 6.4479e-01, PNorm = 52.5942, GNorm = 1.2337, lr_0 = 7.0170e-04
Validation rmse = 0.995063
Epoch 9
Loss = 5.6986e-01, PNorm = 52.6267, GNorm = 0.9977, lr_0 = 6.7628e-04
Validation rmse = 0.987606
Epoch 10
Loss = 8.1802e-01, PNorm = 52.6631, GNorm = 2.3284, lr_0 = 6.5178e-04
Loss = 6.6294e-01, PNorm = 52.7038, GNorm = 1.5177, lr_0 = 6.2817e-04
Validation rmse = 0.875789
Epoch 11
Loss = 6.6110e-01, PNorm = 52.7465, GNorm = 4.4230, lr_0 = 6.0541e-04
Validation rmse = 1.008923
Epoch 12
Loss = 5.0259e-01, PNorm = 52.7839, GNorm = 0.9961, lr_0 = 5.8348e-04
Loss = 6.4630e-01, PNorm = 52.8280, GNorm = 1.5168, lr_0 = 5.6234e-04
Loss = 7.6341e-01, PNorm = 52.8318, GNorm = 2.0001, lr_0 = 5.6027e-04
Validation rmse = 0.979246
Epoch 13
Loss = 5.9444e-01, PNorm = 52.8720, GNorm = 1.9819, lr_0 = 5.3997e-04
Validation rmse = 0.874535
Epoch 14
Loss = 5.2015e-01, PNorm = 52.9152, GNorm = 2.1220, lr_0 = 5.2041e-04
Validation rmse = 0.875502
Epoch 15
Loss = 5.8946e-01, PNorm = 52.9529, GNorm = 1.1566, lr_0 = 5.0156e-04
Loss = 5.5194e-01, PNorm = 52.9985, GNorm = 1.9777, lr_0 = 4.8339e-04
Validation rmse = 0.950229
Epoch 16
Loss = 5.4489e-01, PNorm = 53.0370, GNorm = 3.2935, lr_0 = 4.6587e-04
Validation rmse = 1.083046
Epoch 17
Loss = 6.7023e-01, PNorm = 53.0762, GNorm = 1.4904, lr_0 = 4.4900e-04
Loss = 4.7087e-01, PNorm = 53.1083, GNorm = 1.7740, lr_0 = 4.3273e-04
Validation rmse = 1.039994
Epoch 18
Loss = 5.2921e-01, PNorm = 53.1392, GNorm = 1.3423, lr_0 = 4.1705e-04
Validation rmse = 0.991966
Epoch 19
Loss = 4.5240e-01, PNorm = 53.1720, GNorm = 1.9040, lr_0 = 4.0195e-04
Validation rmse = 0.978710
Epoch 20
Loss = 3.7606e-01, PNorm = 53.1975, GNorm = 1.0665, lr_0 = 3.8738e-04
Loss = 5.4696e-01, PNorm = 53.2256, GNorm = 1.6567, lr_0 = 3.7335e-04
Validation rmse = 0.948258
Epoch 21
Loss = 5.1363e-01, PNorm = 53.2557, GNorm = 1.1522, lr_0 = 3.5982e-04
Validation rmse = 1.012938
Epoch 22
Loss = 4.9095e-01, PNorm = 53.2841, GNorm = 2.0954, lr_0 = 3.4679e-04
Loss = 4.9591e-01, PNorm = 53.3061, GNorm = 1.0769, lr_0 = 3.3422e-04
Validation rmse = 0.950692
Epoch 23
Loss = 4.9477e-01, PNorm = 53.3308, GNorm = 2.2941, lr_0 = 3.2212e-04
Validation rmse = 0.923630
Epoch 24
Loss = 5.2815e-01, PNorm = 53.3527, GNorm = 2.0453, lr_0 = 3.1045e-04
Validation rmse = 0.878610
Epoch 25
Loss = 6.1545e-01, PNorm = 53.3814, GNorm = 2.7100, lr_0 = 2.9920e-04
Loss = 4.1569e-01, PNorm = 53.4045, GNorm = 1.0366, lr_0 = 2.8836e-04
Validation rmse = 0.954930
Epoch 26
Loss = 4.6478e-01, PNorm = 53.4309, GNorm = 1.5339, lr_0 = 2.7689e-04
Validation rmse = 0.929782
Epoch 27
Loss = 3.7516e-01, PNorm = 53.4511, GNorm = 2.0233, lr_0 = 2.6686e-04
Validation rmse = 0.913957
Epoch 28
Loss = 2.6022e-01, PNorm = 53.4696, GNorm = 2.0268, lr_0 = 2.5719e-04
Loss = 4.8731e-01, PNorm = 53.4908, GNorm = 1.5207, lr_0 = 2.4787e-04
Validation rmse = 0.950487
Epoch 29
Loss = 4.9672e-01, PNorm = 53.5088, GNorm = 1.7087, lr_0 = 2.3889e-04
Validation rmse = 0.939953
Epoch 30
Loss = 3.5549e-01, PNorm = 53.5241, GNorm = 1.1666, lr_0 = 2.3024e-04
Loss = 4.7413e-01, PNorm = 53.5411, GNorm = 1.2311, lr_0 = 2.2190e-04
Validation rmse = 0.987576
Epoch 31
Loss = 4.4189e-01, PNorm = 53.5572, GNorm = 1.2155, lr_0 = 2.1386e-04
Validation rmse = 1.017878
Epoch 32
Loss = 4.3194e-01, PNorm = 53.5714, GNorm = 1.0951, lr_0 = 2.0611e-04
Validation rmse = 1.002410
Epoch 33
Loss = 4.0897e-01, PNorm = 53.5845, GNorm = 1.4054, lr_0 = 1.9864e-04
Loss = 4.6407e-01, PNorm = 53.6050, GNorm = 1.3736, lr_0 = 1.9145e-04
Validation rmse = 0.905597
Epoch 34
Loss = 4.2888e-01, PNorm = 53.6193, GNorm = 2.5880, lr_0 = 1.8451e-04
Validation rmse = 0.872227
Epoch 35
Loss = 3.8989e-01, PNorm = 53.6351, GNorm = 2.2057, lr_0 = 1.7783e-04
Loss = 4.3978e-01, PNorm = 53.6471, GNorm = 1.9132, lr_0 = 1.7139e-04
Validation rmse = 0.969226
Epoch 36
Loss = 4.1241e-01, PNorm = 53.6604, GNorm = 1.9217, lr_0 = 1.6518e-04
Validation rmse = 0.962031
Epoch 37
Loss = 3.5709e-01, PNorm = 53.6713, GNorm = 1.3090, lr_0 = 1.5919e-04
Validation rmse = 0.941551
Epoch 38
Loss = 5.0175e-01, PNorm = 53.6812, GNorm = 1.0600, lr_0 = 1.5286e-04
Loss = 4.0801e-01, PNorm = 53.6946, GNorm = 1.3287, lr_0 = 1.4732e-04
Validation rmse = 0.878264
Epoch 39
Loss = 3.9268e-01, PNorm = 53.7033, GNorm = 1.1499, lr_0 = 1.4199e-04
Validation rmse = 0.925135
Epoch 40
Loss = 3.2646e-01, PNorm = 53.7133, GNorm = 1.4663, lr_0 = 1.3684e-04
Loss = 4.1488e-01, PNorm = 53.7230, GNorm = 2.5481, lr_0 = 1.3188e-04
Validation rmse = 0.895092
Epoch 41
Loss = 4.2797e-01, PNorm = 53.7313, GNorm = 1.6490, lr_0 = 1.2711e-04
Validation rmse = 1.031333
Epoch 42
Loss = 4.5644e-01, PNorm = 53.7407, GNorm = 1.1134, lr_0 = 1.2250e-04
Validation rmse = 0.925841
Epoch 43
Loss = 3.5091e-01, PNorm = 53.7494, GNorm = 1.5416, lr_0 = 1.1806e-04
Loss = 4.0895e-01, PNorm = 53.7585, GNorm = 1.5198, lr_0 = 1.1379e-04
Validation rmse = 0.896148
Epoch 44
Loss = 3.8876e-01, PNorm = 53.7651, GNorm = 1.9204, lr_0 = 1.0966e-04
Validation rmse = 0.920750
Epoch 45
Loss = 3.2864e-01, PNorm = 53.7725, GNorm = 1.3074, lr_0 = 1.0569e-04
Loss = 4.0659e-01, PNorm = 53.7777, GNorm = 1.3153, lr_0 = 1.0186e-04
Validation rmse = 0.924273
Epoch 46
Loss = 3.7808e-01, PNorm = 53.7844, GNorm = 1.1127, lr_0 = 1.0000e-04
Validation rmse = 0.864869
Epoch 47
Loss = 3.9988e-01, PNorm = 53.7915, GNorm = 1.4322, lr_0 = 1.0000e-04
Validation rmse = 0.905681
Epoch 48
Loss = 2.4494e-01, PNorm = 53.7982, GNorm = 0.8619, lr_0 = 1.0000e-04
Loss = 4.2487e-01, PNorm = 53.8044, GNorm = 2.0546, lr_0 = 1.0000e-04
Validation rmse = 0.878348
Epoch 49
Loss = 3.2663e-01, PNorm = 53.8111, GNorm = 1.2651, lr_0 = 1.0000e-04
Validation rmse = 0.838388
Model 0 best validation rmse = 0.838388 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Model 0 test rmse = 0.838388
Ensemble test rmse = 0.838388
1-fold cross validation
	Seed 42 ==> test rmse = 0.838388
Overall test rmse = 0.838388 +/- 0.000000
Elapsed time = 0:07:05
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 640 | train size = 640 | val size = 184 | test size = 184
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.1100e+00, PNorm = 52.0800, GNorm = 2.2996, lr_0 = 5.1250e-04
Validation rmse = 0.976922
Epoch 1
Loss = 9.8222e-01, PNorm = 52.1280, GNorm = 2.6882, lr_0 = 9.2500e-04
Validation rmse = 0.911939
Epoch 2
Loss = 8.6174e-01, PNorm = 52.2025, GNorm = 2.6170, lr_0 = 9.6853e-04
Validation rmse = 0.909561
Epoch 3
Loss = 8.2761e-01, PNorm = 52.2720, GNorm = 4.2757, lr_0 = 9.3057e-04
Loss = 8.7396e-01, PNorm = 52.3305, GNorm = 4.1209, lr_0 = 8.9411e-04
Validation rmse = 0.894433
Epoch 4
Loss = 8.1008e-01, PNorm = 52.3843, GNorm = 2.9386, lr_0 = 8.5907e-04
Validation rmse = 0.935151
Epoch 5
Loss = 6.8582e-01, PNorm = 52.4307, GNorm = 4.3466, lr_0 = 8.2540e-04
Validation rmse = 0.853580
Epoch 6
Loss = 8.1252e-01, PNorm = 52.4758, GNorm = 4.3469, lr_0 = 7.8990e-04
Validation rmse = 0.836900
Epoch 7
Loss = 5.0744e-01, PNorm = 52.5181, GNorm = 1.1688, lr_0 = 7.5894e-04
Loss = 6.5765e-01, PNorm = 52.5605, GNorm = 2.6865, lr_0 = 7.2920e-04
Validation rmse = 0.839728
Epoch 8
Loss = 7.4880e-01, PNorm = 52.5960, GNorm = 1.9061, lr_0 = 7.0063e-04
Validation rmse = 0.866950
Epoch 9
Loss = 7.2320e-01, PNorm = 52.6406, GNorm = 2.4662, lr_0 = 6.7317e-04
Validation rmse = 0.923480
Epoch 10
Loss = 6.1648e-01, PNorm = 52.6746, GNorm = 4.1772, lr_0 = 6.4679e-04
Loss = 6.9754e-01, PNorm = 52.7124, GNorm = 5.2838, lr_0 = 6.2145e-04
Loss = 5.8193e-01, PNorm = 52.7176, GNorm = 2.0433, lr_0 = 6.1897e-04
Validation rmse = 0.833052
Epoch 11
Loss = 5.9548e-01, PNorm = 52.7562, GNorm = 1.2894, lr_0 = 5.9471e-04
Validation rmse = 0.845724
Epoch 12
Loss = 5.7592e-01, PNorm = 52.7968, GNorm = 2.4712, lr_0 = 5.7141e-04
Validation rmse = 0.827862
Epoch 13
Loss = 6.0240e-01, PNorm = 52.8279, GNorm = 1.1193, lr_0 = 5.4901e-04
Validation rmse = 0.869280
Epoch 14
Loss = 6.3915e-01, PNorm = 52.8641, GNorm = 2.5000, lr_0 = 5.2750e-04
Loss = 6.0080e-01, PNorm = 52.9064, GNorm = 1.5193, lr_0 = 5.0683e-04
Validation rmse = 0.841872
Epoch 15
Loss = 5.7924e-01, PNorm = 52.9396, GNorm = 3.2477, lr_0 = 4.8697e-04
Validation rmse = 0.811277
Epoch 16
Loss = 5.1794e-01, PNorm = 52.9777, GNorm = 1.9628, lr_0 = 4.6602e-04
Validation rmse = 0.886928
Epoch 17
Loss = 4.7908e-01, PNorm = 53.0146, GNorm = 1.8087, lr_0 = 4.4776e-04
Loss = 5.2948e-01, PNorm = 53.0488, GNorm = 1.9377, lr_0 = 4.3021e-04
Validation rmse = 0.839574
Epoch 18
Loss = 5.1449e-01, PNorm = 53.0815, GNorm = 2.5437, lr_0 = 4.1335e-04
Validation rmse = 0.773199
Epoch 19
Loss = 5.1138e-01, PNorm = 53.1093, GNorm = 3.0576, lr_0 = 3.9715e-04
Validation rmse = 0.842754
Epoch 20
Loss = 5.0802e-01, PNorm = 53.1379, GNorm = 3.4490, lr_0 = 3.8159e-04
Validation rmse = 0.829946
Epoch 21
Loss = 5.0860e-01, PNorm = 53.1721, GNorm = 2.4787, lr_0 = 3.6517e-04
Loss = 4.7082e-01, PNorm = 53.1999, GNorm = 2.8507, lr_0 = 3.5086e-04
Validation rmse = 0.794132
Epoch 22
Loss = 4.4168e-01, PNorm = 53.2268, GNorm = 2.7325, lr_0 = 3.3711e-04
Validation rmse = 0.832121
Epoch 23
Loss = 4.7743e-01, PNorm = 53.2517, GNorm = 1.7686, lr_0 = 3.2390e-04
Validation rmse = 0.876901
Epoch 24
Loss = 4.9732e-01, PNorm = 53.2787, GNorm = 3.1154, lr_0 = 3.1121e-04
Loss = 5.5145e-01, PNorm = 53.3026, GNorm = 3.8591, lr_0 = 2.9902e-04
Validation rmse = 0.864739
Epoch 25
Loss = 4.7489e-01, PNorm = 53.3316, GNorm = 1.0299, lr_0 = 2.8730e-04
Validation rmse = 0.824179
Epoch 26
Loss = 4.8822e-01, PNorm = 53.3597, GNorm = 2.5803, lr_0 = 2.7494e-04
Validation rmse = 0.845623
Epoch 27
Loss = 4.1614e-01, PNorm = 53.3784, GNorm = 1.6476, lr_0 = 2.6416e-04
Validation rmse = 0.781127
Epoch 28
Loss = 5.1401e-01, PNorm = 53.3953, GNorm = 1.3779, lr_0 = 2.5381e-04
Loss = 4.1362e-01, PNorm = 53.4133, GNorm = 1.2604, lr_0 = 2.4387e-04
Validation rmse = 0.782792
Epoch 29
Loss = 4.2126e-01, PNorm = 53.4267, GNorm = 1.1180, lr_0 = 2.3431e-04
Validation rmse = 0.814791
Epoch 30
Loss = 4.3528e-01, PNorm = 53.4440, GNorm = 1.7649, lr_0 = 2.2513e-04
Validation rmse = 0.802284
Epoch 31
Loss = 4.4696e-01, PNorm = 53.4631, GNorm = 1.8078, lr_0 = 2.1544e-04
Validation rmse = 0.818346
Epoch 32
Loss = 2.7144e-01, PNorm = 53.4766, GNorm = 1.2899, lr_0 = 2.0700e-04
Loss = 4.8099e-01, PNorm = 53.4939, GNorm = 2.4555, lr_0 = 1.9889e-04
Validation rmse = 0.786974
Epoch 33
Loss = 4.3211e-01, PNorm = 53.5102, GNorm = 2.2973, lr_0 = 1.9110e-04
Validation rmse = 0.769204
Epoch 34
Loss = 3.6333e-01, PNorm = 53.5246, GNorm = 1.4879, lr_0 = 1.8361e-04
Validation rmse = 0.767774
Epoch 35
Loss = 4.1735e-01, PNorm = 53.5409, GNorm = 1.6536, lr_0 = 1.7641e-04
Loss = 4.1099e-01, PNorm = 53.5508, GNorm = 2.1667, lr_0 = 1.6950e-04
Loss = 3.0077e-01, PNorm = 53.5517, GNorm = 1.0289, lr_0 = 1.6882e-04
Validation rmse = 0.793578
Epoch 36
Loss = 4.0093e-01, PNorm = 53.5630, GNorm = 1.4107, lr_0 = 1.6221e-04
Validation rmse = 0.764897
Epoch 37
Loss = 3.9273e-01, PNorm = 53.5729, GNorm = 2.3013, lr_0 = 1.5585e-04
Validation rmse = 0.776563
Epoch 38
Loss = 4.2181e-01, PNorm = 53.5822, GNorm = 1.1543, lr_0 = 1.4974e-04
Validation rmse = 0.771792
Epoch 39
Loss = 3.6160e-01, PNorm = 53.5896, GNorm = 2.3510, lr_0 = 1.4388e-04
Loss = 3.7612e-01, PNorm = 53.5974, GNorm = 1.6341, lr_0 = 1.3824e-04
Validation rmse = 0.771968
Epoch 40
Loss = 4.1721e-01, PNorm = 53.6042, GNorm = 2.3508, lr_0 = 1.3282e-04
Validation rmse = 0.810337
Epoch 41
Loss = 3.5382e-01, PNorm = 53.6124, GNorm = 1.0675, lr_0 = 1.2711e-04
Validation rmse = 0.774329
Epoch 42
Loss = 3.9788e-01, PNorm = 53.6180, GNorm = 1.4393, lr_0 = 1.2213e-04
Loss = 4.0206e-01, PNorm = 53.6280, GNorm = 1.8155, lr_0 = 1.1734e-04
Validation rmse = 0.759808
Epoch 43
Loss = 3.9974e-01, PNorm = 53.6339, GNorm = 2.8953, lr_0 = 1.1274e-04
Validation rmse = 0.781627
Epoch 44
Loss = 3.4912e-01, PNorm = 53.6403, GNorm = 1.1842, lr_0 = 1.0832e-04
Validation rmse = 0.755974
Epoch 45
Loss = 3.2784e-01, PNorm = 53.6461, GNorm = 1.8676, lr_0 = 1.0408e-04
Validation rmse = 0.760928
Epoch 46
Loss = 3.0311e-01, PNorm = 53.6519, GNorm = 1.6683, lr_0 = 1.0000e-04
Loss = 3.8909e-01, PNorm = 53.6576, GNorm = 1.2141, lr_0 = 1.0000e-04
Validation rmse = 0.757948
Epoch 47
Loss = 3.7921e-01, PNorm = 53.6632, GNorm = 2.7257, lr_0 = 1.0000e-04
Validation rmse = 0.766069
Epoch 48
Loss = 3.9974e-01, PNorm = 53.6686, GNorm = 1.9875, lr_0 = 1.0000e-04
Validation rmse = 0.760845
Epoch 49
Loss = 3.2804e-01, PNorm = 53.6751, GNorm = 2.2492, lr_0 = 1.0000e-04
Loss = 3.6605e-01, PNorm = 53.6816, GNorm = 2.0343, lr_0 = 1.0000e-04
Validation rmse = 0.758207
Model 0 best validation rmse = 0.755974 on epoch 44
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.755974
Ensemble test rmse = 0.755974
1-fold cross validation
	Seed 42 ==> test rmse = 0.755974
Overall test rmse = 0.755974 +/- 0.000000
Elapsed time = 0:01:12
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 596 | train size = 596 | val size = 228 | test size = 228
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.1641e+00, PNorm = 52.0804, GNorm = 5.2913, lr_0 = 5.5000e-04
Validation rmse = 0.949308
Epoch 1
Loss = 9.9959e-01, PNorm = 52.1289, GNorm = 2.1470, lr_0 = 1.0000e-03
Validation rmse = 1.013346
Epoch 2
Loss = 1.0622e+00, PNorm = 52.2066, GNorm = 3.2653, lr_0 = 9.5733e-04
Validation rmse = 0.921755
Epoch 3
Loss = 8.9588e-01, PNorm = 52.2832, GNorm = 2.5888, lr_0 = 9.1648e-04
Validation rmse = 0.963594
Epoch 4
Loss = 8.2519e-01, PNorm = 52.3371, GNorm = 1.2329, lr_0 = 8.7737e-04
Validation rmse = 0.921832
Epoch 5
Loss = 7.6255e-01, PNorm = 52.3819, GNorm = 4.3389, lr_0 = 8.3993e-04
Loss = 7.8528e-01, PNorm = 52.4210, GNorm = 1.8604, lr_0 = 8.0409e-04
Validation rmse = 0.884401
Epoch 6
Loss = 7.6105e-01, PNorm = 52.4568, GNorm = 3.5909, lr_0 = 7.6977e-04
Validation rmse = 0.860382
Epoch 7
Loss = 7.4915e-01, PNorm = 52.4811, GNorm = 2.0218, lr_0 = 7.3693e-04
Validation rmse = 0.896549
Epoch 8
Loss = 7.9089e-01, PNorm = 52.5095, GNorm = 1.0413, lr_0 = 7.0548e-04
Validation rmse = 0.854622
Epoch 9
Loss = 7.8839e-01, PNorm = 52.5437, GNorm = 4.5991, lr_0 = 6.7538e-04
Validation rmse = 0.797742
Epoch 10
Loss = 5.9146e-01, PNorm = 52.5795, GNorm = 1.1081, lr_0 = 6.4656e-04
Loss = 7.2178e-01, PNorm = 52.6136, GNorm = 2.8981, lr_0 = 6.1897e-04
Validation rmse = 0.879197
Epoch 11
Loss = 6.1727e-01, PNorm = 52.6481, GNorm = 1.7574, lr_0 = 5.9255e-04
Validation rmse = 0.840510
Epoch 12
Loss = 6.9660e-01, PNorm = 52.6742, GNorm = 1.4018, lr_0 = 5.6727e-04
Validation rmse = 0.832220
Epoch 13
Loss = 6.2865e-01, PNorm = 52.7063, GNorm = 2.9635, lr_0 = 5.4070e-04
Validation rmse = 0.829700
Epoch 14
Loss = 6.3787e-01, PNorm = 52.7343, GNorm = 2.1086, lr_0 = 5.1762e-04
Validation rmse = 0.841703
Epoch 15
Loss = 7.0510e-01, PNorm = 52.7612, GNorm = 2.1182, lr_0 = 4.9554e-04
Loss = 5.8864e-01, PNorm = 52.7952, GNorm = 1.4204, lr_0 = 4.7439e-04
Validation rmse = 0.862523
Epoch 16
Loss = 6.2184e-01, PNorm = 52.8215, GNorm = 1.3304, lr_0 = 4.5415e-04
Validation rmse = 0.921452
Epoch 17
Loss = 5.9755e-01, PNorm = 52.8502, GNorm = 1.9414, lr_0 = 4.3477e-04
Validation rmse = 0.841693
Epoch 18
Loss = 5.7560e-01, PNorm = 52.8806, GNorm = 0.9999, lr_0 = 4.1622e-04
Validation rmse = 0.871548
Epoch 19
Loss = 5.6065e-01, PNorm = 52.9064, GNorm = 2.7523, lr_0 = 3.9845e-04
Validation rmse = 0.827587
Epoch 20
Loss = 4.5797e-01, PNorm = 52.9334, GNorm = 0.9585, lr_0 = 3.8145e-04
Loss = 5.9800e-01, PNorm = 52.9606, GNorm = 1.6818, lr_0 = 3.6517e-04
Validation rmse = 0.839024
Epoch 21
Loss = 5.6294e-01, PNorm = 52.9823, GNorm = 1.1865, lr_0 = 3.4959e-04
Validation rmse = 0.847610
Epoch 22
Loss = 5.6308e-01, PNorm = 53.0054, GNorm = 1.2677, lr_0 = 3.3467e-04
Validation rmse = 0.832264
Epoch 23
Loss = 4.9221e-01, PNorm = 53.0265, GNorm = 1.5575, lr_0 = 3.2039e-04
Validation rmse = 0.845562
Epoch 24
Loss = 4.7645e-01, PNorm = 53.0517, GNorm = 1.1574, lr_0 = 3.0672e-04
Validation rmse = 0.833071
Epoch 25
Loss = 5.2379e-01, PNorm = 53.0732, GNorm = 1.4979, lr_0 = 2.9363e-04
Validation rmse = 0.826893
Epoch 26
Loss = 4.0357e-01, PNorm = 53.0951, GNorm = 1.3686, lr_0 = 2.7988e-04
Loss = 5.2147e-01, PNorm = 53.1172, GNorm = 2.8241, lr_0 = 2.6794e-04
Validation rmse = 0.829808
Epoch 27
Loss = 4.6687e-01, PNorm = 53.1388, GNorm = 1.7915, lr_0 = 2.5650e-04
Validation rmse = 0.816978
Epoch 28
Loss = 4.8092e-01, PNorm = 53.1574, GNorm = 5.6255, lr_0 = 2.4556e-04
Validation rmse = 0.784413
Epoch 29
Loss = 5.0490e-01, PNorm = 53.1787, GNorm = 2.4885, lr_0 = 2.3508e-04
Validation rmse = 0.780164
Epoch 30
Loss = 4.2647e-01, PNorm = 53.1975, GNorm = 1.3218, lr_0 = 2.2505e-04
Validation rmse = 0.779958
Epoch 31
Loss = 2.2700e-01, PNorm = 53.2140, GNorm = 1.6006, lr_0 = 2.1544e-04
Loss = 4.7290e-01, PNorm = 53.2282, GNorm = 2.0508, lr_0 = 2.0625e-04
Validation rmse = 0.761635
Epoch 32
Loss = 4.3342e-01, PNorm = 53.2447, GNorm = 1.8811, lr_0 = 1.9745e-04
Validation rmse = 0.748346
Epoch 33
Loss = 4.2761e-01, PNorm = 53.2588, GNorm = 2.5484, lr_0 = 1.8902e-04
Validation rmse = 0.792564
Epoch 34
Loss = 5.1042e-01, PNorm = 53.2725, GNorm = 2.3109, lr_0 = 1.8096e-04
Validation rmse = 0.752249
Epoch 35
Loss = 5.6322e-01, PNorm = 53.2863, GNorm = 1.2853, lr_0 = 1.7324e-04
Validation rmse = 0.731717
Epoch 36
Loss = 6.7161e-01, PNorm = 53.2989, GNorm = 2.6980, lr_0 = 1.6584e-04
Loss = 4.4896e-01, PNorm = 53.3100, GNorm = 2.0732, lr_0 = 1.5877e-04
Validation rmse = 0.741879
Epoch 37
Loss = 4.5097e-01, PNorm = 53.3221, GNorm = 1.5593, lr_0 = 1.5199e-04
Validation rmse = 0.723400
Epoch 38
Loss = 3.7731e-01, PNorm = 53.3337, GNorm = 1.1992, lr_0 = 1.4487e-04
Validation rmse = 0.709650
Epoch 39
Loss = 4.6275e-01, PNorm = 53.3441, GNorm = 1.4651, lr_0 = 1.3869e-04
Validation rmse = 0.719858
Epoch 40
Loss = 4.7639e-01, PNorm = 53.3540, GNorm = 2.2126, lr_0 = 1.3277e-04
Validation rmse = 0.734637
Epoch 41
Loss = 5.0477e-01, PNorm = 53.3618, GNorm = 3.3712, lr_0 = 1.2711e-04
Loss = 4.1089e-01, PNorm = 53.3702, GNorm = 2.9397, lr_0 = 1.2168e-04
Validation rmse = 0.730585
Epoch 42
Loss = 4.0929e-01, PNorm = 53.3766, GNorm = 1.1342, lr_0 = 1.1649e-04
Validation rmse = 0.701694
Epoch 43
Loss = 4.5228e-01, PNorm = 53.3840, GNorm = 3.4417, lr_0 = 1.1152e-04
Validation rmse = 0.707285
Epoch 44
Loss = 4.5912e-01, PNorm = 53.3926, GNorm = 1.9127, lr_0 = 1.0676e-04
Validation rmse = 0.721246
Epoch 45
Loss = 3.3252e-01, PNorm = 53.3994, GNorm = 1.5853, lr_0 = 1.0220e-04
Validation rmse = 0.744381
Epoch 46
Loss = 4.2000e-01, PNorm = 53.4042, GNorm = 2.8149, lr_0 = 1.0000e-04
Loss = 4.2907e-01, PNorm = 53.4105, GNorm = 2.3011, lr_0 = 1.0000e-04
Validation rmse = 0.696059
Epoch 47
Loss = 4.1892e-01, PNorm = 53.4172, GNorm = 1.3125, lr_0 = 1.0000e-04
Validation rmse = 0.721643
Epoch 48
Loss = 4.0011e-01, PNorm = 53.4223, GNorm = 2.2293, lr_0 = 1.0000e-04
Validation rmse = 0.688933
Epoch 49
Loss = 3.8450e-01, PNorm = 53.4280, GNorm = 1.6315, lr_0 = 1.0000e-04
Validation rmse = 0.695839
Model 0 best validation rmse = 0.688933 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.688933
Ensemble test rmse = 0.688933
1-fold cross validation
	Seed 42 ==> test rmse = 0.688933
Overall test rmse = 0.688933 +/- 0.000000
Elapsed time = 0:01:05
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 716 | train size = 716 | val size = 108 | test size = 108
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.1215e+00, PNorm = 52.0770, GNorm = 3.3347, lr_0 = 4.5357e-04
Validation rmse = 0.850410
Epoch 1
Loss = 1.1123e+00, PNorm = 52.1048, GNorm = 2.3595, lr_0 = 8.0714e-04
Validation rmse = 0.846204
Epoch 2
Loss = 9.2316e-01, PNorm = 52.1772, GNorm = 2.2795, lr_0 = 9.8301e-04
Loss = 9.5687e-01, PNorm = 52.2635, GNorm = 2.1710, lr_0 = 9.4990e-04
Validation rmse = 0.734937
Epoch 3
Loss = 8.3038e-01, PNorm = 52.3298, GNorm = 1.6883, lr_0 = 9.1476e-04
Validation rmse = 0.763644
Epoch 4
Loss = 6.9207e-01, PNorm = 52.3908, GNorm = 1.7416, lr_0 = 8.8395e-04
Loss = 8.4116e-01, PNorm = 52.4299, GNorm = 1.6394, lr_0 = 8.5418e-04
Validation rmse = 0.701597
Epoch 5
Loss = 7.2169e-01, PNorm = 52.4781, GNorm = 3.0143, lr_0 = 8.2258e-04
Validation rmse = 0.805701
Epoch 6
Loss = 8.3221e-01, PNorm = 52.5155, GNorm = 2.4373, lr_0 = 7.9215e-04
Loss = 7.2769e-01, PNorm = 52.5514, GNorm = 1.6178, lr_0 = 7.6547e-04
Validation rmse = 0.718594
Epoch 7
Loss = 7.3811e-01, PNorm = 52.5904, GNorm = 1.2303, lr_0 = 7.3969e-04
Validation rmse = 0.686600
Epoch 8
Loss = 7.0758e-01, PNorm = 52.6287, GNorm = 2.0224, lr_0 = 7.1233e-04
Validation rmse = 0.735165
Epoch 9
Loss = 6.0893e-01, PNorm = 52.6630, GNorm = 1.4474, lr_0 = 6.8598e-04
Loss = 7.0939e-01, PNorm = 52.7012, GNorm = 1.6121, lr_0 = 6.6287e-04
Validation rmse = 0.712919
Epoch 10
Loss = 7.0618e-01, PNorm = 52.7445, GNorm = 3.4737, lr_0 = 6.4054e-04
Validation rmse = 0.706926
Epoch 11
Loss = 7.1524e-01, PNorm = 52.7897, GNorm = 4.9821, lr_0 = 6.1685e-04
Loss = 6.6995e-01, PNorm = 52.8310, GNorm = 1.6030, lr_0 = 5.9607e-04
Validation rmse = 0.688584
Epoch 12
Loss = 6.5112e-01, PNorm = 52.8798, GNorm = 1.0488, lr_0 = 5.7402e-04
Validation rmse = 0.692174
Epoch 13
Loss = 5.8778e-01, PNorm = 52.9157, GNorm = 2.5494, lr_0 = 5.5469e-04
Loss = 6.4459e-01, PNorm = 52.9446, GNorm = 1.2322, lr_0 = 5.3600e-04
Loss = 5.9175e-01, PNorm = 52.9484, GNorm = 2.3371, lr_0 = 5.3417e-04
Validation rmse = 0.666927
Epoch 14
Loss = 6.2326e-01, PNorm = 52.9839, GNorm = 1.4395, lr_0 = 5.1618e-04
Validation rmse = 0.698241
Epoch 15
Loss = 5.9440e-01, PNorm = 53.0189, GNorm = 1.7252, lr_0 = 4.9708e-04
Validation rmse = 0.661090
Epoch 16
Loss = 8.5122e-01, PNorm = 53.0519, GNorm = 2.4613, lr_0 = 4.8034e-04
Loss = 5.5573e-01, PNorm = 53.0854, GNorm = 3.1405, lr_0 = 4.6416e-04
Validation rmse = 0.649864
Epoch 17
Loss = 5.8544e-01, PNorm = 53.1159, GNorm = 1.1097, lr_0 = 4.4699e-04
Validation rmse = 0.667028
Epoch 18
Loss = 5.0613e-01, PNorm = 53.1508, GNorm = 2.1980, lr_0 = 4.3046e-04
Loss = 6.0926e-01, PNorm = 53.1830, GNorm = 2.7623, lr_0 = 4.1596e-04
Validation rmse = 0.670489
Epoch 19
Loss = 6.2364e-01, PNorm = 53.2144, GNorm = 1.9941, lr_0 = 4.0195e-04
Validation rmse = 0.700713
Epoch 20
Loss = 4.9261e-01, PNorm = 53.2506, GNorm = 1.6855, lr_0 = 3.8708e-04
Loss = 5.4060e-01, PNorm = 53.2810, GNorm = 1.2955, lr_0 = 3.7404e-04
Loss = 6.4599e-01, PNorm = 53.2838, GNorm = 3.8908, lr_0 = 3.7276e-04
Validation rmse = 0.653597
Epoch 21
Loss = 4.5752e-01, PNorm = 53.3150, GNorm = 3.3331, lr_0 = 3.6020e-04
Validation rmse = 0.659769
Epoch 22
Loss = 4.2664e-01, PNorm = 53.3428, GNorm = 1.9776, lr_0 = 3.4807e-04
Validation rmse = 0.738783
Epoch 23
Loss = 4.9550e-01, PNorm = 53.3833, GNorm = 4.7934, lr_0 = 3.3520e-04
Loss = 5.8167e-01, PNorm = 53.4092, GNorm = 3.7968, lr_0 = 3.2390e-04
Validation rmse = 0.644473
Epoch 24
Loss = 5.5559e-01, PNorm = 53.4405, GNorm = 1.4363, lr_0 = 3.1192e-04
Validation rmse = 0.646915
Epoch 25
Loss = 3.9902e-01, PNorm = 53.4646, GNorm = 1.7037, lr_0 = 3.0142e-04
Loss = 5.2704e-01, PNorm = 53.4905, GNorm = 2.2472, lr_0 = 2.9126e-04
Validation rmse = 0.656460
Epoch 26
Loss = 3.8658e-01, PNorm = 53.5148, GNorm = 1.2320, lr_0 = 2.8049e-04
Validation rmse = 0.636039
Epoch 27
Loss = 4.1037e-01, PNorm = 53.5346, GNorm = 2.9390, lr_0 = 2.7011e-04
Loss = 5.1591e-01, PNorm = 53.5601, GNorm = 1.7990, lr_0 = 2.6102e-04
Loss = 8.5175e-01, PNorm = 53.5619, GNorm = 4.9932, lr_0 = 2.6012e-04
Validation rmse = 0.648957
Epoch 28
Loss = 4.6038e-01, PNorm = 53.5839, GNorm = 1.6622, lr_0 = 2.5136e-04
Validation rmse = 0.649840
Epoch 29
Loss = 5.1516e-01, PNorm = 53.6069, GNorm = 2.6818, lr_0 = 2.4289e-04
Validation rmse = 0.633740
Epoch 30
Loss = 3.8835e-01, PNorm = 53.6290, GNorm = 1.5899, lr_0 = 2.3391e-04
Loss = 4.6648e-01, PNorm = 53.6470, GNorm = 1.6882, lr_0 = 2.2603e-04
Validation rmse = 0.648027
Epoch 31
Loss = 4.4055e-01, PNorm = 53.6614, GNorm = 2.2269, lr_0 = 2.1767e-04
Validation rmse = 0.632543
Epoch 32
Loss = 3.3877e-01, PNorm = 53.6788, GNorm = 1.2345, lr_0 = 2.1034e-04
Loss = 4.3845e-01, PNorm = 53.6952, GNorm = 1.3748, lr_0 = 2.0325e-04
Validation rmse = 0.652603
Epoch 33
Loss = 4.7898e-01, PNorm = 53.7132, GNorm = 8.3132, lr_0 = 1.9573e-04
Validation rmse = 0.627471
Epoch 34
Loss = 3.9208e-01, PNorm = 53.7258, GNorm = 1.1438, lr_0 = 1.8849e-04
Loss = 4.4622e-01, PNorm = 53.7395, GNorm = 1.6895, lr_0 = 1.8214e-04
Validation rmse = 0.627891
Epoch 35
Loss = 4.3187e-01, PNorm = 53.7518, GNorm = 1.0510, lr_0 = 1.7601e-04
Validation rmse = 0.629736
Epoch 36
Loss = 4.8881e-01, PNorm = 53.7647, GNorm = 1.0659, lr_0 = 1.6950e-04
Validation rmse = 0.644383
Epoch 37
Loss = 3.4300e-01, PNorm = 53.7791, GNorm = 1.2571, lr_0 = 1.6323e-04
Loss = 4.1948e-01, PNorm = 53.7870, GNorm = 1.7522, lr_0 = 1.5773e-04
Validation rmse = 0.623033
Epoch 38
Loss = 3.6486e-01, PNorm = 53.7954, GNorm = 2.1301, lr_0 = 1.5242e-04
Validation rmse = 0.629848
Epoch 39
Loss = 3.8550e-01, PNorm = 53.8065, GNorm = 1.0129, lr_0 = 1.4678e-04
Loss = 3.9168e-01, PNorm = 53.8173, GNorm = 1.5405, lr_0 = 1.4184e-04
Validation rmse = 0.624505
Epoch 40
Loss = 4.0208e-01, PNorm = 53.8279, GNorm = 1.6839, lr_0 = 1.3659e-04
Validation rmse = 0.632329
Epoch 41
Loss = 4.2641e-01, PNorm = 53.8352, GNorm = 1.2024, lr_0 = 1.3199e-04
Loss = 3.9975e-01, PNorm = 53.8425, GNorm = 1.4548, lr_0 = 1.2754e-04
Validation rmse = 0.630835
Epoch 42
Loss = 4.1799e-01, PNorm = 53.8496, GNorm = 1.6579, lr_0 = 1.2282e-04
Validation rmse = 0.631231
Epoch 43
Loss = 4.0193e-01, PNorm = 53.8567, GNorm = 1.6032, lr_0 = 1.1828e-04
Loss = 3.9062e-01, PNorm = 53.8638, GNorm = 2.0455, lr_0 = 1.1430e-04
Validation rmse = 0.622001
Epoch 44
Loss = 3.8698e-01, PNorm = 53.8707, GNorm = 2.6398, lr_0 = 1.1045e-04
Validation rmse = 0.623335
Epoch 45
Loss = 3.8479e-01, PNorm = 53.8770, GNorm = 3.0186, lr_0 = 1.0636e-04
Validation rmse = 0.624429
Epoch 46
Loss = 3.0031e-01, PNorm = 53.8830, GNorm = 1.2138, lr_0 = 1.0243e-04
Loss = 3.8990e-01, PNorm = 53.8892, GNorm = 2.1381, lr_0 = 1.0000e-04
Validation rmse = 0.633533
Epoch 47
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –-epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 640 | train size = 640 | val size = 184 | test size = 184
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.1100e+00, PNorm = 52.0800, GNorm = 2.2996, lr_0 = 5.1250e-04
Validation rmse = 0.976922
Epoch 1
Loss = 9.8222e-01, PNorm = 52.1280, GNorm = 2.6882, lr_0 = 9.2500e-04
Validation rmse = 0.908241
Epoch 2
Loss = 7.9682e-01, PNorm = 52.1763, GNorm = 7.0842, lr_0 = 2.1544e-04
Validation rmse = 0.944264
Model 0 best validation rmse = 0.908241 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.908241
Ensemble test rmse = 0.908241
1-fold cross validation
	Seed 42 ==> test rmse = 0.908241
Overall test rmse = 0.908241 +/- 0.000000
Elapsed time = 0:00:08
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –-epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 596 | train size = 596 | val size = 228 | test size = 228
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.1641e+00, PNorm = 52.0804, GNorm = 5.2913, lr_0 = 5.5000e-04
Validation rmse = 0.949308
Epoch 1
Loss = 9.9959e-01, PNorm = 52.1289, GNorm = 2.1470, lr_0 = 1.0000e-03
Validation rmse = 1.020998
Epoch 2
Loss = 1.0364e+00, PNorm = 52.1600, GNorm = 1.7170, lr_0 = 1.2328e-04
Validation rmse = 0.953682
Model 0 best validation rmse = 0.949308 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.949308
Ensemble test rmse = 0.949308
1-fold cross validation
	Seed 42 ==> test rmse = 0.949308
Overall test rmse = 0.949308 +/- 0.000000
Elapsed time = 0:00:05
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –-epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 716 | train size = 716 | val size = 108 | test size = 108
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.1215e+00, PNorm = 52.0770, GNorm = 3.3347, lr_0 = 4.5357e-04
Validation rmse = 0.850410
Epoch 1
Loss = 1.1123e+00, PNorm = 52.1048, GNorm = 2.3595, lr_0 = 8.0714e-04
Validation rmse = 0.855752
Epoch 2
Loss = 9.0442e-01, PNorm = 52.1659, GNorm = 1.3686, lr_0 = 4.3940e-04
Loss = 9.7022e-01, PNorm = 52.1792, GNorm = 1.1586, lr_0 = 1.0000e-04
Validation rmse = 0.795800
Model 0 best validation rmse = 0.795800 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.795800
Ensemble test rmse = 0.795800
1-fold cross validation
	Seed 42 ==> test rmse = 0.795800
Overall test rmse = 0.795800 +/- 0.000000
Elapsed time = 0:00:05
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –-epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 718 | train size = 718 | val size = 106 | test size = 106
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.2159e+00, PNorm = 52.0771, GNorm = 2.4369, lr_0 = 4.5357e-04
Validation rmse = 1.090019
Epoch 1
Loss = 1.1351e+00, PNorm = 52.1120, GNorm = 3.7383, lr_0 = 8.0714e-04
Validation rmse = 1.103190
Epoch 2
Loss = 9.0079e-01, PNorm = 52.1689, GNorm = 1.3951, lr_0 = 4.3940e-04
Loss = 1.0504e+00, PNorm = 52.1803, GNorm = 1.4036, lr_0 = 1.0000e-04
Validation rmse = 1.096173
Model 0 best validation rmse = 1.090019 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 1.090019
Ensemble test rmse = 1.090019
1-fold cross validation
	Seed 42 ==> test rmse = 1.090019
Overall test rmse = 1.090019 +/- 0.000000
Elapsed time = 0:00:05
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –-epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 626 | train size = 626 | val size = 198 | test size = 198
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.1226e+00, PNorm = 52.0801, GNorm = 2.2930, lr_0 = 5.1250e-04
Validation rmse = 0.986922
Epoch 1
Loss = 1.0660e+00, PNorm = 52.1211, GNorm = 3.5194, lr_0 = 9.2500e-04
Validation rmse = 1.072584
Epoch 2
Loss = 9.3201e-01, PNorm = 52.1704, GNorm = 2.1003, lr_0 = 2.1544e-04
Validation rmse = 0.960926
Model 0 best validation rmse = 0.960926 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.960926
Ensemble test rmse = 0.960926
1-fold cross validation
	Seed 42 ==> test rmse = 0.960926
Overall test rmse = 0.960926 +/- 0.000000
Elapsed time = 0:00:05
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –-epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 657 | train size = 657 | val size = 147 | test size = 147
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.0550e+00, PNorm = 52.0779, GNorm = 2.2202, lr_0 = 4.8077e-04
Validation rmse = 0.834972
Epoch 1
Loss = 9.9245e-01, PNorm = 52.1153, GNorm = 6.4458, lr_0 = 8.6154e-04
Validation rmse = 0.891934
Epoch 2
Loss = 1.0381e+00, PNorm = 52.1739, GNorm = 1.4935, lr_0 = 2.8943e-04
Validation rmse = 0.837040
Model 0 best validation rmse = 0.834972 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.834972
Ensemble test rmse = 0.834972
1-fold cross validation
	Seed 42 ==> test rmse = 0.834972
Overall test rmse = 0.834972 +/- 0.000000
Elapsed time = 0:00:08
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –-epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 611 | train size = 611 | val size = 193 | test size = 193
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.1272e+00, PNorm = 52.0793, GNorm = 2.7563, lr_0 = 5.1250e-04
Validation rmse = 1.117654
Epoch 1
Loss = 9.9699e-01, PNorm = 52.1218, GNorm = 1.7496, lr_0 = 9.2500e-04
Validation rmse = 1.276929
Epoch 2
Loss = 1.1640e+00, PNorm = 52.1648, GNorm = 3.9267, lr_0 = 1.7783e-04
Validation rmse = 0.950081
Model 0 best validation rmse = 0.950081 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.950081
Ensemble test rmse = 0.950081
1-fold cross validation
	Seed 42 ==> test rmse = 0.950081
Overall test rmse = 0.950081 +/- 0.000000
Elapsed time = 0:00:05
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –-epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 615 | train size = 615 | val size = 189 | test size = 189
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.0762e+00, PNorm = 52.0807, GNorm = 2.6856, lr_0 = 5.1250e-04
Validation rmse = 1.070361
Epoch 1
Loss = 9.7356e-01, PNorm = 52.1238, GNorm = 1.5098, lr_0 = 9.2500e-04
Validation rmse = 1.059134
Epoch 2
Loss = 6.9219e-01, PNorm = 52.1774, GNorm = 1.3599, lr_0 = 1.7783e-04
Validation rmse = 1.009675
Model 0 best validation rmse = 1.009675 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 1.009675
Ensemble test rmse = 1.009675
1-fold cross validation
	Seed 42 ==> test rmse = 1.009675
Overall test rmse = 1.009675 +/- 0.000000
Elapsed time = 0:00:05
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –-epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 677 | train size = 677 | val size = 127 | test size = 127
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.0651e+00, PNorm = 52.0788, GNorm = 1.9459, lr_0 = 4.8077e-04
Validation rmse = 1.325661
Epoch 1
Loss = 1.0827e+00, PNorm = 52.1187, GNorm = 4.6505, lr_0 = 8.6154e-04
Validation rmse = 1.269859
Epoch 2
Loss = 1.0855e+00, PNorm = 52.1754, GNorm = 1.0736, lr_0 = 3.4551e-04
Loss = 9.0670e-01, PNorm = 52.1912, GNorm = 2.4072, lr_0 = 1.0000e-04
Loss = 7.6706e-01, PNorm = 52.1918, GNorm = 1.9271, lr_0 = 1.0000e-04
Validation rmse = 1.242191
Model 0 best validation rmse = 1.242191 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 1.242191
Ensemble test rmse = 1.242191
1-fold cross validation
	Seed 42 ==> test rmse = 1.242191
Overall test rmse = 1.242191 +/- 0.000000
Elapsed time = 0:00:05
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –-epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 656 | train size = 656 | val size = 148 | test size = 148
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.0488e+00, PNorm = 52.0807, GNorm = 4.0128, lr_0 = 4.8077e-04
Validation rmse = 1.032913
Epoch 1
Loss = 9.3920e-01, PNorm = 52.1187, GNorm = 2.5840, lr_0 = 8.6154e-04
Validation rmse = 0.973457
Epoch 2
Loss = 1.0152e+00, PNorm = 52.1751, GNorm = 6.7806, lr_0 = 2.8943e-04
Validation rmse = 1.006380
Model 0 best validation rmse = 0.973457 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.973457
Ensemble test rmse = 0.973457
1-fold cross validation
	Seed 42 ==> test rmse = 0.973457
Overall test rmse = 0.973457 +/- 0.000000
Elapsed time = 0:00:05
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –-epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_0/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 683 | train size = 683 | val size = 129 | test size = 129
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.1264e+00, PNorm = 52.0792, GNorm = 3.1463, lr_0 = 4.8077e-04
Validation rmse = 1.416799
Epoch 1
Loss = 1.0389e+00, PNorm = 52.1182, GNorm = 1.5536, lr_0 = 8.6154e-04
Validation rmse = 1.421002
Epoch 2
Loss = 1.1219e+00, PNorm = 52.1677, GNorm = 2.1663, lr_0 = 3.4551e-04
Loss = 1.0224e+00, PNorm = 52.1801, GNorm = 1.2931, lr_0 = 1.0000e-04
Loss = 1.1681e+00, PNorm = 52.1804, GNorm = 3.7984, lr_0 = 1.0000e-04
Validation rmse = 1.382902
Model 0 best validation rmse = 1.382902 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 1.382902
Ensemble test rmse = 1.382902
1-fold cross validation
	Seed 42 ==> test rmse = 1.382902
Overall test rmse = 1.382902 +/- 0.000000
Elapsed time = 0:00:10
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –-epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_1/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 558 | train size = 558 | val size = 254 | test size = 254
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 9.7465e-01, PNorm = 52.0844, GNorm = 3.2293, lr_0 = 5.5000e-04
Validation rmse = 0.985685
Epoch 1
Loss = 9.6288e-01, PNorm = 52.1380, GNorm = 1.6540, lr_0 = 1.0000e-03
Validation rmse = 0.939725
Epoch 2
Loss = 8.0200e-01, PNorm = 52.1804, GNorm = 1.2366, lr_0 = 1.0000e-04
Validation rmse = 0.927245
Model 0 best validation rmse = 0.927245 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.927245
Ensemble test rmse = 0.927245
1-fold cross validation
	Seed 42 ==> test rmse = 0.927245
Overall test rmse = 0.927245 +/- 0.000000
Elapsed time = 0:00:05
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –-epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_2/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 677 | train size = 677 | val size = 135 | test size = 135
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.1044e+00, PNorm = 52.0779, GNorm = 2.3347, lr_0 = 4.8077e-04
Validation rmse = 0.860540
Epoch 1
Loss = 9.4139e-01, PNorm = 52.1223, GNorm = 4.1504, lr_0 = 8.6154e-04
Validation rmse = 0.903150
Epoch 2
Loss = 8.6504e-01, PNorm = 52.1817, GNorm = 1.4827, lr_0 = 3.4551e-04
Loss = 7.7847e-01, PNorm = 52.1925, GNorm = 3.4377, lr_0 = 1.0000e-04
Loss = 1.0022e+00, PNorm = 52.1924, GNorm = 5.0120, lr_0 = 1.0000e-04
Validation rmse = 0.768091
Model 0 best validation rmse = 0.768091 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.768091
Ensemble test rmse = 0.768091
1-fold cross validation
	Seed 42 ==> test rmse = 0.768091
Overall test rmse = 0.768091 +/- 0.000000
Elapsed time = 0:00:05
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –-epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_3/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 659 | train size = 659 | val size = 153 | test size = 153
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.0748e+00, PNorm = 52.0790, GNorm = 5.1826, lr_0 = 4.8077e-04
Validation rmse = 1.282651
Epoch 1
Loss = 1.0102e+00, PNorm = 52.1157, GNorm = 1.7163, lr_0 = 8.6154e-04
Validation rmse = 1.098381
Epoch 2
Loss = 8.4680e-01, PNorm = 52.1716, GNorm = 5.1185, lr_0 = 2.8943e-04
Validation rmse = 0.902893
Model 0 best validation rmse = 0.902893 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.902893
Ensemble test rmse = 0.902893
1-fold cross validation
	Seed 42 ==> test rmse = 0.902893
Overall test rmse = 0.902893 +/- 0.000000
Elapsed time = 0:00:05
Command line
python main_script.py train small_test_split_with_ultra_held_out_for_in_silico_screen –-epochs 3
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': '../data/args_files/optimized_configs.json',
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train.csv',
 'data_weights_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train_weights.csv',
 'dataset_type': 'regression',
 'depth': 4,
 'depth_solvent': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/train_extra_x.csv'],
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 600,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 600,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'ignore_nan_metrics': False,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile_loss_alpha': 0.1,
 'quantiles': [],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/test_extra_x.csv'],
 'separate_test_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': ['../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/valid_extra_x.csv'],
 'separate_val_path': '../data/crossval_splits/small_test_split_with_ultra_held_out_for_in_silico_screen/cv_4/valid.csv',
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [1.0, 0.0, 0.0],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['quantified_delivery'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 42
Total size = 671 | train size = 671 | val size = 141 | test size = 141
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=600, bias=False)
        (W_h): Linear(in_features=600, out_features=600, bias=False)
        (W_o): Linear(in_features=733, out_features=600, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=636, out_features=600, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=600, out_features=600, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=600, out_features=1, bias=True)
  )
)
Number of parameters = 1,632,601
Moving model to cuda
Epoch 0
Loss = 1.0947e+00, PNorm = 52.0794, GNorm = 9.7606, lr_0 = 4.8077e-04
Validation rmse = 0.885553
Epoch 1
Loss = 9.4643e-01, PNorm = 52.1193, GNorm = 2.1057, lr_0 = 8.6154e-04
Validation rmse = 0.874001
Epoch 2
Loss = 8.5247e-01, PNorm = 52.1779, GNorm = 6.4705, lr_0 = 2.8943e-04
Loss = 7.6074e-01, PNorm = 52.1870, GNorm = 6.7813, lr_0 = 1.0000e-04
Validation rmse = 0.831785
Model 0 best validation rmse = 0.831785 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Loading pretrained parameter "readout.7.weight".
Loading pretrained parameter "readout.7.bias".
Moving model to cuda
Model 0 test rmse = 0.831785
Ensemble test rmse = 0.831785
1-fold cross validation
	Seed 42 ==> test rmse = 0.831785
Overall test rmse = 0.831785 +/- 0.000000
Elapsed time = 0:00:05
